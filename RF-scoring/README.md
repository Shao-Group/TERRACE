# Generating Scores using CircRNA Random Forest Classifier

We provide a Python script `random_forest_train_test.py` which is designed to test a Random Forest classifier on circular RNA (circRNA) datasets based on a pretrained model (trained on human brain sample).

## Requirements

This script requires Python 3 and the following Python libraries:

- NumPy
- pandas
- scikit-learn
- joblib

### Installation with pip

You can install the required packages using `pip` if you are using a standard Python environment:

```bash
pip install numpy pandas scikit-learn joblib
```

### Installation with conda

If you are using a conda environment (recommended for managing dependencies), you can install the required packages using `conda`:

```bash
conda install numpy pandas scikit-learn joblib
```

### Testing

To test the pre-trained model, use the `test` command with the following syntax:

```bash
python3 random_forest_train_test.py test -m brain.pre_trained.joblib -i feature_file -o output_folder/prefix
```

* Replace `feature_file` with the feature file generated by TERRACE using the `-fe` command. See usage of TERRACE for more details.
* Replace output_folder/prefix with the path to your desired output folder and the prefix for the output files.

This command will:

1. Load the specified pre-trained model.
2. Test the model using the provided testing data files.
3. Output the prediction probabilities (scores) to files following the pattern output_folder/prefix.feature_file.prob.csv, with circRNA_id followed by the corresponding probabilities (scores) in the range 0 to 1.

An example feature file `feature_file` and the generated probabilities/score file `test.feature_file.prob.csv` using the above commands are provided in the `example` folder for reference.

# Integrating the Scores

Use the provided script `integrate.py` to embedd the scores from the Random Forest model `prefix.feature_file.prob.csv` into the `output.gtf` file generated by TERRACE. The usage is:

```
python3 integrate.py <output.gtf> <prefix.feature_file.prob.csv> <output-with-score.gtf>
```

`output.gtf` is the original GTF file produced by TERRACE with abundance values in the `score` field.

`prefix.feature_file.prob.csv` is a list of circRNA_id and score tuples generated from the Random Forest testing commands.

`output-with-score.gtf` is a modified GTF file with the same list of circRNAs as in `output.gtf` but the `score` field changed to represent Random Forest scores instead of abundance.


